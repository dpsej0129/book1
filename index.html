<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì±… ìš”ì•½ & ë¦¬ë·° ì‚¬ì´íŠ¸</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 20px auto;
      padding: 0 10px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    input, select {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }
    button {
      padding: 10px;
      background-color: #007bff;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      margin-bottom: 10px;
    }
    button:hover {
      background-color: #0056b3;
    }
    ul {
      list-style-type: none;
      padding: 0;
    }
    li {
      background-color: #f4f4f4;
      margin: 10px 0;
      padding: 15px;
      border-radius: 8px;
    }
    .highlight {
      background-color: yellow;
    }
    #recent-books {
      margin-top: 30px;
      border-top: 1px solid #ccc;
      padding-top: 10px;
    }
  </style>
</head>
<body>
  <h1>ğŸ“š ì±… ìš”ì•½ & ë¦¬ë·°</h1>

  <input type="text" id="searchInput" placeholder="ì±… ì œëª©ì´ë‚˜ ë‚´ìš©ì„ ê²€ìƒ‰í•˜ì„¸ìš”" />

  <select id="categoryFilter">
    <option value="ì „ì²´">ì „ì²´</option>
    <option value="ìê¸°ê³„ë°œ">ìê¸°ê³„ë°œ</option>
    <option value="ì‹¬ë¦¬í•™">ì‹¬ë¦¬í•™</option>
    <option value="ì—­ì‚¬">ì—­ì‚¬</option>
  </select>

  <button id="showAllBtn">ëª¨ë“  ì±… ë³´ê¸°</button>

  <ul id="bookList"></ul>

  <div id="recent-books">
    <h3>ğŸ“Œ ìµœê·¼ ë³¸ ì±…</h3>
    <ul id="recentList"></ul>
  </div>

  <script>
    const bookData = [
      {
        title: "ë¯¸ë¼í´ ëª¨ë‹",
        summary: "ê¸°ì  ê°™ì€ ì•„ì¹¨ ìŠµê´€ìœ¼ë¡œ ì¸ìƒì„ ë°”ê¾¸ëŠ” ë°©ë²•",
        category: "ìê¸°ê³„ë°œ",
        url: "book1.html"
      },
      {
        title: "ê·¸ë¦¿",
        summary: "ëˆê¸°ì˜ í˜ê³¼ ì„±ê³µì˜ ë¹„ë°€",
        category: "ì‹¬ë¦¬í•™",
        url: "book2.html"
      },
      {
        title: "ì‚¬í”¼ì—”ìŠ¤",
        summary: "ì¸ê°„ì˜ ì—­ì‚¬ì™€ ë¬¸ëª…ì˜ ê¸°ì›",
        category: "ì—­ì‚¬",
        url: "book3.html"
      }
    ];

    const bookList = document.getElementById("bookList");
    const searchInput = document.getElementById("searchInput");
    const categoryFilter = document.getElementById("categoryFilter");
    const showAllBtn = document.getElementById("showAllBtn");
    const recentList = document.getElementById("recentList");

    let showAll = false;

    function highlightText(text, keyword) {
      if (!keyword) return text;
      return text.replace(new RegExp(`(${keyword})`, "gi"), '<span class="highlight">$1</span>');
    }

    function displayBooks(query = "", category = "ì „ì²´") {
      bookList.innerHTML = "";

      const filteredBooks = bookData.filter(book => {
        const matchQuery = book.title.includes(query) || book.summary.includes(query);
        const matchCategory = category === "ì „ì²´" || book.category === category;
        return matchQuery && matchCategory;
      });

      const booksToShow = showAll ? filteredBooks : filteredBooks.slice(0, 0);

      booksToShow.forEach(book => {
        const highlightedTitle = highlightText(book.title, query);
        const highlightedSummary = highlightText(book.summary, query);

        bookList.innerHTML += `
          <li>
            <a href="${book.url}" class="book-link" data-title="${book.title}" data-summary="${book.summary}" data-url="${book.url}" style="color: black; text-decoration: none;">
              ${highlightedTitle}
            </a> - ${highlightedSummary}
          </li>
        `;
      });

      if (showAll) {
        showAllBtn.style.display = "none";
      }
    }

    function saveRecentBook(book) {
      let recent = JSON.parse(localStorage.getItem("recentBooks")) || [];
      recent = recent.filter(b => b.title !== book.title); // ì¤‘ë³µ ì œê±°
      recent.unshift(book); // ê°€ì¥ ì•ì— ì¶”ê°€
      if (recent.length > 5) recent.pop(); // ìµœëŒ€ 5ê°œ
      localStorage.setItem("recentBooks", JSON.stringify(recent));
      loadRecentBooks();
    }

    function loadRecentBooks() {
      const recent = JSON.parse(localStorage.getItem("recentBooks")) || [];
      recentList.innerHTML = "";
      recent.forEach(book => {
        recentList.innerHTML += `
          <li><a href="${book.url}" style="text-decoration:none; color:black;">${book.title}</a></li>
        `;
      });
    }

    // ì´ë²¤íŠ¸ ì—°ê²°
    searchInput.addEventListener("input", () => {
      showAll = true;
      displayBooks(searchInput.value, categoryFilter.value);
    });

    categoryFilter.addEventListener("change", () => {
      showAll = true;
      displayBooks(searchInput.value, categoryFilter.value);
    });

    showAllBtn.addEventListener("click", () => {
      showAll = true;
      displayBooks(searchInput.value, categoryFilter.value);
    });

    bookList.addEventListener("click", (e) => {
      if (e.target.closest(".book-link")) {
        const link = e.target.closest(".book-link");
        const title = link.dataset.title;
        const summary = link.dataset.summary;
        const url = link.dataset.url;
        saveRecentBook({ title, summary, url });
      }
    });

    // ì´ˆê¸° ì‹¤í–‰
    displayBooks();
    loadRecentBooks();
  </script>
</body>
</html>
